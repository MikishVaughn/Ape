@page
@model DeleteAccountModel
@{
    ViewData["Title"] = "Delete Account";
    ViewData["ActivePage"] = ManageNavPages.DeleteAccount;
}

<div class="row justify-content-center">
    <div class="col-md-10 col-lg-8">

        <!-- Warning Alert -->
        <div class="alert alert-danger mb-4" role="alert">
            <h4 class="alert-heading"><i class="bi bi-exclamation-triangle-fill me-2"></i>Warning: Permanent Action</h4>
            <p class="mb-0">
                Deleting your account will <strong>permanently remove</strong> all your data, including:
            </p>
            <ul class="mt-2 mb-0">
                <li>Your profile information and settings</li>
                <li>Your account credentials and login access</li>
                <li>All associated data stored in the system</li>
            </ul>
            <hr>
            <p class="mb-0">
                <strong>This action cannot be undone.</strong> Once deleted, your data cannot be recovered.
            </p>
        </div>

        <!-- Deletion Card -->
        <div class="card border-danger">
            <div class="card-header bg-danger text-white">
                <h5 class="mb-0"><i class="bi bi-trash3 me-2"></i>Delete My Account</h5>
            </div>
            <div class="card-body">
                <form id="delete-account-form" method="post" asp-page-handler="Delete">
                    <div asp-validation-summary="ModelOnly" class="text-danger mb-3" role="alert"></div>

                    @if (Model.RequirePassword)
                    {
                        <div class="mb-3">
                            <label asp-for="Input.Password" class="form-label">Confirm your password</label>
                            <input asp-for="Input.Password" class="form-control" autocomplete="current-password" placeholder="Enter your password" />
                            <span asp-validation-for="Input.Password" class="text-danger"></span>
                        </div>
                    }

                    <div class="mb-4">
                        <div class="form-check">
                            <input asp-for="Input.ConfirmDeletion" class="form-check-input" type="checkbox" />
                            <label asp-for="Input.ConfirmDeletion" class="form-check-label">
                                I understand that deleting my account is <strong>permanent and irreversible</strong>
                            </label>
                            <span asp-validation-for="Input.ConfirmDeletion" class="text-danger d-block"></span>
                        </div>
                    </div>

                    <div class="d-grid gap-2">
                        <button type="submit" class="btn btn-danger" id="delete-btn" disabled>
                            <i class="bi bi-trash3 me-2"></i>Permanently Delete My Account
                        </button>
                        <a asp-page="./Index" class="btn btn-outline-secondary">
                            <i class="bi bi-arrow-left me-2"></i>Cancel
                        </a>
                    </div>
                </form>
            </div>
        </div>

    </div>
</div>

@section Scripts {
    <partial name="_ValidationScriptsPartial" />
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            const checkbox = document.getElementById('Input_ConfirmDeletion');
            const deleteBtn = document.getElementById('delete-btn');

            if (checkbox && deleteBtn) {
                deleteBtn.disabled = !checkbox.checked;

                checkbox.addEventListener('change', function() {
                    deleteBtn.disabled = !this.checked;
                });
            }
        });
    </script>
}
